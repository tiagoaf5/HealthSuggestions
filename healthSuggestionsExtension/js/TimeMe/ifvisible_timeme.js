(function(){(function(g,a){return"function"===typeof define&&define.amd?define(function(){return a()}):"object"===typeof exports?module.exports=a():g.ifvisible=a()})(this,function(){var g,a,c,d,m,h,r,k,n,p,e,t,l;k={};c=document;p=!1;e="active";h=6E4;m=!1;a=function(){var f;f={};return{add:function(b,a,c){b.__ceGUID=void 0;b.__ceGUID||(b.__ceGUID="ifvisible.object.event.identifier");f[b.__ceGUID]||(f[b.__ceGUID]={});f[b.__ceGUID][a]||(f[b.__ceGUID][a]=[]);return f[b.__ceGUID][a].push(c)},remove:function(b,
a,c){var d,e,q,g,h;if(c){if(b.__ceGUID&&f[b.__ceGUID]&&f[b.__ceGUID][a])for(h=f[b.__ceGUID][a],e=q=0,g=h.length;q<g;e=++q)if(d=h[e],d===c)return f[b.__ceGUID][a].splice(e,1),d}else if(b.__ceGUID&&f[b.__ceGUID]&&f[b.__ceGUID][a])return delete f[b.__ceGUID][a]},fire:function(b,a,c){var d,e,h;if(b.__ceGUID&&f[b.__ceGUID]&&f[b.__ceGUID][a]){e=f[b.__ceGUID][a];h=[];a=0;for(d=e.length;a<d;a++)b=e[a],h.push(b(c||{}));return h}}}}();g=function(){var a;a=!1;return function(b,c,d){a||(a=b.addEventListener?
function(a,b,f){return a.addEventListener(b,f,!1)}:b.attachEvent?function(a,b,f){return a.attachEvent("on"+b,f,!1)}:function(a,b,f){return a["on"+b]=f});return a(b,c,d)}}();r=function(){var a,b,d,e;e=3;d=c.createElement("div");a=d.getElementsByTagName("i");for(b=function(){return d.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",a[0]};b(););if(4<e)return e}();d=!1;l=void 0;"undefined"!==typeof c.hidden?(d="hidden",l="visibilitychange"):"undefined"!==typeof c.mozHidden?(d="mozHidden",
l="mozvisibilitychange"):"undefined"!==typeof c.msHidden?(d="msHidden",l="msvisibilitychange"):"undefined"!==typeof c.webkitHidden&&(d="webkitHidden",l="webkitvisibilitychange");t=function(){var a,b;a=!1;b=function(){clearTimeout(a);"active"!==e&&k.wakeup();m=+new Date;return a=setTimeout(function(){if("active"===e)return k.idle()},h)};b();g(c,"mousemove",b);g(c,"keyup",b);g(window,"scroll",b);k.focus(b);return k.wakeup(b)};n=function(){var a;if(p)return!0;!1===d?(a="blur",9>r&&(a="focusout"),g(window,
a,function(){return k.blur()}),g(window,"focus",function(){return k.focus()})):g(c,l,function(){return c[d]?k.blur():k.focus()},!1);p=!0;return t()};return k={setIdleDuration:function(a){return h=1E3*a},getIdleDuration:function(){return h},getIdleInfo:function(){var a,b;a=+new Date;b={};"idle"===e?(b.isIdle=!0,b.idleFor=a-m,b.timeLeft=0,b.timeLeftPer=100):(b.isIdle=!1,b.idleFor=a-m,b.timeLeft=m+h-a,b.timeLeftPer=(100-100*b.timeLeft/h).toFixed(2));return b},focus:function(c){if("function"===typeof c)return this.on("focus",
c);e="active";a.fire(this,"focus");a.fire(this,"wakeup");return a.fire(this,"statusChanged",{status:e})},blur:function(c){if("function"===typeof c)return this.on("blur",c);e="hidden";a.fire(this,"blur");a.fire(this,"idle");return a.fire(this,"statusChanged",{status:e})},idle:function(c){if("function"===typeof c)return this.on("idle",c);e="idle";a.fire(this,"idle");return a.fire(this,"statusChanged",{status:e})},wakeup:function(c){if("function"===typeof c)return this.on("wakeup",c);e="active";a.fire(this,
"wakeup");return a.fire(this,"statusChanged",{status:e})},on:function(c,b){n();return a.add(this,c,b)},off:function(c,b){n();return a.remove(this,c,b)},onEvery:function(a,b){var c,d;n();c=!1;b&&(d=setInterval(function(){if("active"===e&&!1===c)return b()},1E3*a));return{stop:function(){return clearInterval(d)},pause:function(){return c=!0},resume:function(){return c=!1},code:d,callback:b}},now:function(a){n();return e===(a||"active")}}})}).call(this);(function(g){TimeMe={startStopTimes:{},idleTimeout:60,currentPageName:"default-page-name",getIfVisibleHandle:function(){if("object"===typeof g)return g;"undefined"!==typeof console&&console.log("Required dependency (ifvisible.js) not found.  Make sure it has been included.");throw{name:"MissingDependencyException",message:"Required dependency (ifvisible.js) not found.  Make sure it has been included."};},startTimer:function(){var a=TimeMe.currentPageName;if(void 0===TimeMe.startStopTimes[a])TimeMe.startStopTimes[a]=
[];else{var c=TimeMe.startStopTimes[a],c=c[c.length-1];if(void 0!==c&&void 0===c.stopTime)return}TimeMe.startStopTimes[a].push({startTime:new Date,stopTime:void 0})},stopTimer:function(){var a=TimeMe.startStopTimes[TimeMe.currentPageName];void 0!==a&&0!==a.length&&void 0===a[a.length-1].stopTime&&(a[a.length-1].stopTime=new Date)},getTimeOnCurrentPageInSeconds:function(){return TimeMe.getTimeOnPageInSeconds(TimeMe.currentPageName)},getTimeOnPageInSeconds:function(a){var c=0;a=TimeMe.startStopTimes[a];
if(void 0!==a){for(var d=c=0;d<a.length;d++){var g=a[d].startTime,h=a[d].stopTime;void 0===h&&(h=new Date);c+=(h-g)/1E3}return c=Number(c)}},getTimeOnAllPagesInSeconds:function(){for(var a=[],c=Object.keys(TimeMe.startStopTimes),d=0;d<c.length;d++){var g=c[d],h=TimeMe.getTimeOnPageInSeconds(g);a.push({pageName:g,timeOnPage:h})}return a},setIdleDurationInSeconds:function(a){var c=parseFloat(a);if(!1===isNaN(c))TimeMe.getIfVisibleHandle().setIdleDuration(c),TimeMe.idleTimeout=c;else throw{name:"InvalidDurationException",
message:"An invalid duration time ("+a+") was provided."};},setCurrentPageName:function(a){TimeMe.currentPageName=a},resetRecordedPageTime:function(a){delete TimeMe.startStopTimes[a]},resetAllRecordedPageTimes:function(){for(var a=Object.keys(TimeMe.startStopTimes),c=0;c<a.length;c++)TimeMe.resetRecordedPageTime(a[c])},listenForVisibilityEvents:function(){TimeMe.getIfVisibleHandle().on("blur",function(){TimeMe.stopTimer()});TimeMe.getIfVisibleHandle().on("focus",function(){TimeMe.startTimer()});TimeMe.getIfVisibleHandle().on("idle",
function(){0<TimeMe.idleTimeout&&TimeMe.stopTimer()});TimeMe.getIfVisibleHandle().on("wakeup",function(){0<TimeMe.idleTimeout&&TimeMe.startTimer()})},initialize:function(){TimeMe.listenForVisibilityEvents();TimeMe.startTimer()}};"function"===typeof define&&define.amd?define(function(){return TimeMe}):window.TimeMe=TimeMe})(this.ifvisible);